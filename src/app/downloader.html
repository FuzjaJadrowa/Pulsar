<div class="page-container full-height-layout">

  <div class="scroll-content">

    <div class="page-header">
      <img src="assets/icons/downloader.png" style="width: 32px; height: 32px; filter: brightness(0) invert(1);">
      <span class="page-title">Downloader</span>
    </div>

    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
      <input type="text" id="url-input" class="custom-input" placeholder="Paste YouTube link here..." style="flex: 2;">
      <input type="text" id="path-input" class="custom-input" placeholder="Download path..." style="flex: 1;">
      <button class="anim-btn" style="width: 100px; background: #333; color: white; border: 1px solid #444;">Browse</button>
    </div>

    <div style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.05); display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 10px;">

      <div>
        <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 13px;">Video Format:</label>
        <select id="video-fmt" class="custom-select" style="width: 100%;">
          <option>Default</option><option>mp4</option><option>mkv</option><option>mov</option><option>avi</option><option>webm</option>
        </select>
      </div>

      <div>
        <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 13px;">Video Quality:</label>
        <select id="video-qual" class="custom-select" style="width: 100%;">
          <option>Default</option><option>2160p</option><option>1440p</option><option>1080p</option><option>720p</option><option>480p</option>
        </select>
      </div>

      <div style="grid-row: span 3; padding-top: 28px;">
        <label class="custom-checkbox">
          <input type="checkbox" id="audio-only-check">
          <span class="checkmark"></span>
          Audio only mode
        </label>
      </div>

      <div>
        <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 13px;">Audio Format:</label>
        <select id="audio-fmt" class="custom-select" style="width: 100%;" disabled>
          <option>Default</option><option>mp3</option><option>m4a</option><option>aac</option><option>opus</option><option>wav</option>
        </select>
      </div>

      <div>
        <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 13px;">Audio Quality:</label>
        <select id="audio-qual" class="custom-select" style="width: 100%;" disabled>
          <option>Default</option><option>320kbps</option><option>256kbps</option><option>192kbps</option><option>128kbps</option>
        </select>
      </div>
    </div>

    <div style="display: flex; gap: 30px; margin-bottom: 10px; padding: 0 5px;">
      <div style="flex: 1; display: flex; flex-direction: column; gap: 10px;">
        <div style="display: flex; align-items: center; gap: 10px;">
          <label class="custom-checkbox">
            <input type="checkbox" id="subs-check">
            <span class="checkmark"></span>
            Download subtitles
          </label>
          <input type="text" id="subs-code" class="custom-input" placeholder="Code" style="width: 60px;" disabled>
        </div>
        <label class="custom-checkbox">
          <input type="checkbox" id="chat-check">
          <span class="checkmark"></span>
          Download live chat
        </label>
      </div>

      <div style="flex: 1;">
        <div style="margin-bottom: 8px; font-size: 13px; color: #e0e0e0;">Download fragments (hh:mm:ss):</div>
        <div style="display: flex; align-items: center; gap: 8px;">
          <input type="text" class="custom-input" style="width: 80px; text-align: center;">
          <span style="color:#aaa">-</span>
          <input type="text" class="custom-input" style="width: 80px; text-align: center;">
        </div>
      </div>
    </div>

    <button class="advanced-toggle" id="advanced-toggle-btn">
      Advanced Settings ▼
    </button>

    <div id="adv-content" class="advanced-content">
      <div style="padding-top: 10px;">
        <label style="display: block; margin-bottom: 5px; color: #aaa; font-size: 12px;">Custom Arguments:</label>
        <input type="text" class="custom-input" style="width: 100%; margin-bottom: 15px;">
      </div>
    </div>
  </div>

  <div class="fixed-footer">
    <button class="anim-btn" style="width: 140px; height: 50px; background: #00e676; color: white;">Download</button>
    <button class="anim-btn" style="width: 140px; height: 50px; background: #2979ff; color: white;" onclick="addToQueueSim()">Add to queue</button>
  </div>
</div>

<script>
  {

    const audioCheck = document.getElementById('audio-only-check');
    const subsCheck = document.getElementById('subs-check');
    const chatCheck = document.getElementById('chat-check');
    const advBtn = document.getElementById('advanced-toggle-btn');

    const updateAudioState = () => {
      const isAudio = audioCheck.checked;
      document.getElementById('video-fmt').disabled = isAudio;
      document.getElementById('video-qual').disabled = isAudio;
      document.getElementById('audio-fmt').disabled = !isAudio;
      document.getElementById('audio-qual').disabled = !isAudio;
    };

    const updateSubsState = () => {
      const hasSubs = subsCheck.checked;
      document.getElementById('subs-code').disabled = !hasSubs;
      if(hasSubs) chatCheck.checked = false;
    };

    const updateChatState = () => {
      if(chatCheck.checked) {
        subsCheck.checked = false;
        updateSubsState();
      }
    };

    audioCheck.addEventListener('change', updateAudioState);
    subsCheck.addEventListener('change', updateSubsState);
    chatCheck.addEventListener('change', updateChatState);

    advBtn.addEventListener('click', function() {
      const content = document.getElementById('adv-content');
      const isOpen = content.classList.contains('open');
      if (isOpen) {
        content.classList.remove('open');
        this.innerText = "Advanced Settings ▼";
      } else {
        content.classList.add('open');
        this.innerText = "Advanced Settings ▲";
      }
    });

    updateAudioState();
    if (window.initCustomSelects) window.initCustomSelects();
  }

  function addToQueueSim() {
    const qBtn = document.getElementById('btn-queue');
    if(qBtn) qBtn.style.display = 'flex';
  }
</script>